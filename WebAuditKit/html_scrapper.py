import httplib
from bs4 import BeautifulSoup

class html_scrapper:

    def __init__(self, host, port_list, working_dir):
        self.host = host
        self.port_list = port_list
        self.working_dir = working_dir
        self.start_scrapping()

    def start_scrapping(self):
        for port in self.port_list:
            if port[1] == '80' or port[1] == '443' and port[2] == 'up':
                self.analyze_html(port[1])

    def analyze_html(self, port):
        conn = httplib.HTTPConnection(self.host, port, timeout=10)
        conn.request('GET', '/')
        res = conn.getresponse()
        data = res.read()

        bs = BeautifulSoup(data, 'html.parser')
        scripts = bs.findAll('script')
        for script in scripts:
            #print script
            #print "\n\n"
            if script.find(self.host, 0, len(script)) != -1:
                print script

